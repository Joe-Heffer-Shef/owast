# Development environment
services:

  # Emulator for Azure Blob Storage
  blob:
    image: mcr.microsoft.com/azure-storage/azurite

  # Azure Cosmo DB emulator
  meta:
    image: mongo
    volumes:
      # Import scripts
      - ./meta:/meta

  # Web app for data entry
  app:
    build:
      context: .
      dockerfile: owast/Dockerfile
    volumes:
      # Allow editing of files without rebuilding images
      - ./owast:/owast
    ports:
      - 8000:8000
    environment:
      - FLASK_ENV=development
      - MONGO_URI=mongodb://meta:27017/owast
      - BIND=0.0.0.0:8000
      - WSGI_APP=owast.app_factory:create_app()
      - CHDIR=/
      # Auto-reload upon code change
      - RELOAD=True
    restart: always
